<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard Pro | PerfumeStore</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="style.css"> 
</head>

<body class="admin-body">
    <div id="admin-login-overlay" class="position-fixed top-0 start-0 w-100 h-100 bg-white d-flex justify-content-center align-items-center" style="z-index: 9999;">
        <div class="text-center" style="max-width: 350px;">
            <img src="pic/logo4.png" alt="Logo" class="mb-4" style="height: 70px;">
            <h3 class="fw-bold mb-4">Quản trị viên</h3>
            <form id="admin-login-form">
                <div class="form-floating mb-3">
                    <input type="email" class="form-control" id="admin-email" placeholder="Email" required>
                    <label>Email</label>
                </div>
                <div class="form-floating mb-4">
                    <input type="password" class="form-control" id="admin-pass" placeholder="Password" required>
                    <label>Mật khẩu</label>
                </div>
                <div id="admin-login-error" class="text-danger mb-3 small"></div>
                <button type="submit" class="btn btn-primary btn-lg w-100 fw-bold">Đăng nhập</button>
            </form>
        </div>
    </div>
    
    <aside class="sidebar d-flex flex-column">
        <div class="sidebar-header">
            <h4 class="text-white fw-bold m-0">PERFUME<span style="color:#3699ff;">ADMIN</span></h4>
        </div>

        <ul class="sidebar-menu list-unstyled flex-grow-1">
            <li class="sidebar-item active" data-section="tong-quan">
                <a href="#" class="sidebar-link"><i class="bi bi-grid-fill"></i> Tổng quan</a>
            </li>
            <li class="sidebar-item" data-section="san-pham">
                <a href="#" class="sidebar-link"><i class="bi bi-box-seam-fill"></i> Sản phẩm</a>
            </li>
            <li class="sidebar-item" data-section="don-hang">
                <a href="#" class="sidebar-link"><i class="bi bi-cart-fill"></i> Đơn hàng</a>
            </li>
            <li class="sidebar-item" data-section="khach-hang">
                <a href="#" class="sidebar-link"><i class="bi bi-people-fill"></i> Khách hàng</a>
            </li>
            <li class="sidebar-item" data-section="thuong-hieu">
                <a href="#" class="sidebar-link"><i class="bi bi-tags-fill"></i> Thương hiệu</a>
            </li>
            <li class="sidebar-item" data-section="danh-muc">
                <a href="#" class="sidebar-link"><i class="bi bi-list-ul"></i> Danh mục</a>
            </li>
            <li class="sidebar-item" data-section="thong-ke">
                <a href="#" class="sidebar-link"><i class="bi bi-bar-chart-line-fill"></i> Báo cáo</a>
            </li>
        </ul>

        <div class="p-3">
            <button id="logout-acc" class="btn btn-danger w-100 py-2"><i class="bi bi-power me-2"></i>Đăng xuất</button>
        </div>
    </aside>

    <main class="main-content p-4">
        <div class="d-lg-none mb-4 d-flex justify-content-between align-items-center">
            <h4 class="fw-bold">Menu</h4>
            <button class="btn btn-light menu-toggle"><i class="bi bi-list fs-3"></i></button>
        </div>

       <section id="tong-quan" class="section active">
            <div class="mb-4">
                <h3 class="fw-bold text-dark">Dashboard</h3>
                <p class="text-muted">Chào mừng trở lại, Admin!</p>
            </div>
            
            <div class="row g-4 mb-4">
                <div class="col-md-3">
                    <div class="stat-card p-4 h-100 bg-white shadow-sm rounded-3" onclick="window.navigateTo('thong-ke')" style="cursor: pointer;">
                        <div class="d-flex justify-content-between align-items-start">
                            <div>
                                <p class="text-muted fw-bold small mb-1">DOANH THU</p>
                                <h3 class="fw-bold text-dark mb-0" id="dash-revenue">0 đ</h3>
                            </div>
                            <div class="icon-wrapper p-3 rounded-3" style="background: #e8fff3; color: #50cd89;">
                                <i class="bi bi-currency-dollar fs-4"></i>
                            </div>
                        </div>
                        <div class="mt-3 small text-success"><i class="bi bi-arrow-up-short"></i> Doanh thu thực nhận</div>
                    </div>
                </div>

                <div class="col-md-3">
                    <div class="stat-card p-4 h-100 bg-white shadow-sm rounded-3" onclick="window.navigateTo('don-hang')" style="cursor: pointer;">
                        <div class="d-flex justify-content-between align-items-start">
                            <div>
                                <p class="text-muted fw-bold small mb-1">ĐƠN CHỜ XỬ LÝ</p>
                                <h3 class="fw-bold text-dark mb-0" id="dash-orders">0</h3>
                            </div>
                            <div class="icon-wrapper p-3 rounded-3" style="background: #fff8dd; color: #ffc700;">
                                <i class="bi bi-bag-check fs-4"></i>
                            </div>
                        </div>
                        <div class="mt-3 small text-muted">Đơn hàng cần duyệt ngay</div>
                    </div>
                </div>

                <div class="col-md-3">
                    <div class="stat-card p-4 h-100 bg-white shadow-sm rounded-3" onclick="window.navigateTo('san-pham')" style="cursor: pointer;">
                        <div class="d-flex justify-content-between align-items-start">
                            <div>
                                <p class="text-muted fw-bold small mb-1">KHO SẢN PHẨM</p>
                                <h3 class="fw-bold text-dark mb-0" id="dash-products">0</h3>
                            </div>
                            <div class="icon-wrapper p-3 rounded-3" style="background: #ffe2e5; color: #f1416c;">
                                <i class="bi bi-box-seam fs-4"></i>
                            </div>
                        </div>
                         <div class="mt-3 small text-muted">Sản phẩm đang kinh doanh</div>
                    </div>
                </div>

                <div class="col-md-3">
                    <div class="stat-card p-4 h-100 bg-white shadow-sm rounded-3" onclick="window.navigateTo('khach-hang')" style="cursor: pointer;">
                        <div class="d-flex justify-content-between align-items-start">
                            <div>
                                <p class="text-muted fw-bold small mb-1">KHÁCH HÀNG</p>
                                <h3 class="fw-bold text-dark mb-0" id="dash-users">0</h3>
                            </div>
                            <div class="icon-wrapper p-3 rounded-3" style="background: #e1f0ff; color: #3699ff;">
                                <i class="bi bi-people fs-4"></i>
                            </div>
                        </div>
                        <div class="mt-3 small text-primary">Thành viên hệ thống</div>
                    </div>
                </div>
            </div>

            <div class="row g-4">
                <div class="col-md-8">
                    <div class="card border-0 shadow-sm rounded-3 h-100">
                        <div class="card-header bg-white border-0 py-3 d-flex justify-content-between align-items-center">
                            <h5 class="fw-bold m-0">Hiệu quả kinh doanh</h5>
                            <select class="form-select w-auto shadow-none border-gray-300 py-1" id="chart-filter" style="font-size: 0.9rem;">
                                <option value="day">Theo Ngày</option>
                                <option value="month">Theo Tháng</option>
                                <option value="year">Theo Năm</option>
                            </select>
                        </div>
                        <div class="card-body">
                            <canvas id="revenueChart" style="max-height: 350px;"></canvas>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card border-0 shadow-sm rounded-3 h-100">
                        <div class="card-header bg-white border-0 py-3">
                            <h5 class="fw-bold m-0">Tỉ lệ đơn hàng</h5>
                        </div>
                        <div class="card-body d-flex flex-column justify-content-center align-items-center">
                            <div style="width: 100%; max-width: 250px;">
                                <canvas id="statusChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="san-pham" class="section">
             <div class="d-flex justify-content-between align-items-center mb-4">
                <h3 class="fw-bold">Kho Hàng</h3>
                <button class="btn btn-primary-pro py-2 px-4 rounded-3" id="btn-add-product"><i class="bi bi-plus-lg me-2"></i>Thêm Mới</button>
            </div>
            <div class="card border-0 shadow-sm rounded-3">
                <div class="card-body p-0">
                    <div id="show-product" class="table-responsive"></div>
                </div>
            </div>
            <nav class="mt-4"><ul class="pagination justify-content-center" id="admin-pagination"></ul></nav>
        </section>

        <section id="don-hang" class="section">
            <h3 class="fw-bold mb-4">Danh sách Đơn hàng</h3>
            <div class="card border-0 shadow-sm rounded-3 overflow-hidden">
                <div class="card-body p-0">
                    <div class="table-responsive">
                        <table class="table table-custom mb-0">
                            <thead><tr><th>Mã đơn</th><th>Khách hàng</th><th>Ngày đặt</th><th>Tổng tiền</th><th>Trạng thái</th><th>Thao tác</th></tr></thead>
                            <tbody id="showOrder"></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>

        <section id="khach-hang" class="section">
            <h3 class="fw-bold mb-4">Danh sách Khách hàng</h3>
             <div class="card border-0 shadow-sm rounded-3 overflow-hidden">
                <div class="card-body p-0">
                    <table class="table table-custom mb-0">
                        <thead><tr><th>STT</th><th>Họ tên</th><th>Email</th><th>Ngày tham gia</th><th>Trạng thái</th><th class="text-center">Hành động</th></tr></thead>
                        <tbody id="show-user"></tbody>
                    </table>
                </div>
            </div>
        </section>

        <section id="thuong-hieu" class="section">
             <div class="d-flex justify-content-between align-items-center mb-4">
                <h3 class="fw-bold">Thương hiệu</h3>
                <button class="btn btn-primary-pro rounded-3 px-3" onclick="window.addNewBrand()"><i class="bi bi-plus-circle me-2"></i>Thêm Hãng</button>
            </div>
            <div class="card border-0 shadow-sm rounded-3">
                <div class="card-body p-0">
                    <table class="table table-custom mb-0">
                        <thead><tr><th>Logo</th><th>Tên thương hiệu</th><th>Mô tả</th><th class="text-end">Hành động</th></tr></thead>
                        <tbody id="show-brand"></tbody>
                    </table>
                </div>
            </div>
        </section>

        <section id="danh-muc" class="section">
             <div class="d-flex justify-content-between align-items-center mb-4">
                <h3 class="fw-bold">Danh mục Sản phẩm</h3>
                <button class="btn btn-primary-pro rounded-3 px-3" onclick="window.addNewCategory()"><i class="bi bi-plus-circle me-2"></i>Thêm Mục</button>
            </div>
            <div class="card border-0 shadow-sm rounded-3">
                <div class="card-body p-0">
                    <table class="table table-custom mb-0">
                        <thead><tr><th>ID</th><th>Tên danh mục</th><th>Mô tả</th><th class="text-end">Hành động</th></tr></thead>
                        <tbody id="show-category"></tbody>
                    </table>
                </div>
            </div>
        </section>

       <section id="thong-ke" class="section">
            <h3 class="fw-bold mb-4">Thống kê & Báo cáo</h3>
            
            <div class="row g-4 mb-4">
                <div class="col-md-7">
                     <div class="card border-0 shadow-sm rounded-3 h-100">
                        <div class="card-header bg-white py-3 border-0">
                            <h5 class="fw-bold m-0">Doanh thu theo Thương hiệu</h5>
                        </div>
                        <div class="card-body">
                            <canvas id="brandChart" style="max-height: 300px;"></canvas>
                        </div>
                    </div>
                </div>
                <div class="col-md-5">
                     <div class="card border-0 shadow-sm rounded-3 h-100">
                        <div class="card-header bg-white py-3 border-0">
                            <h5 class="fw-bold m-0">Phân bố Danh mục</h5>
                        </div>
                        <div class="card-body d-flex justify-content-center align-items-center">
                            <div style="width: 80%;">
                                <canvas id="categoryChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row g-4 mb-4">
                <div class="col-md-8">
                     <div class="card border-0 shadow-sm rounded-3 h-100">
                        <div class="card-header bg-white py-3"><h5 class="fw-bold m-0">Top 5 Sản phẩm Bán chạy</h5></div>
                        <div class="card-body p-0">
                            <table class="table table-custom mb-0 align-middle">
                                <thead class="bg-light"><tr><th class="ps-4">#</th><th>Sản phẩm</th><th class="text-center">Số lượng bán</th><th class="text-center">Tồn kho</th><th class="text-end pe-4">Doanh thu</th></tr></thead>
                                <tbody id="showTk"></tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                     <div class="card border-0 shadow-sm rounded-3 h-100 bg-white">
                        <div class="card-header bg-white py-3 border-bottom-0"><h5 class="fw-bold m-0 text-danger">Cảnh báo Tồn kho</h5></div>
                        <div class="card-body" id="low-stock-alert"></div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <div class="modal fade" id="addProductModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content rounded-4 border-0 shadow-lg">
                <div class="modal-header border-bottom-0"><h5 class="modal-title fw-bold">Thông tin sản phẩm</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div>
                <div class="modal-body pt-0">
                    <form id="form-add-product">
                        <input type="hidden" id="edit-product-id">
                        <div class="row g-3">
                            <div class="col-md-8">
                                <div class="mb-3"><label class="form-label fw-bold small text-muted">Tên sản phẩm</label><input type="text" class="form-control bg-light border-0" id="new-name"></div>
                               <div class="row">
                                <div class="col-6 mb-3">
                                    <label class="form-label fw-bold small text-muted">Thương hiệu</label>
                                    <select class="form-select bg-light border-0" id="new-brand">
                                        <option value="dior">Dior</option><option value="chanel">Chanel</option><option value="gucci">Gucci</option><option value="versace">Versace</option><option value="ysl">YSL</option><option value="tomford">Tom Ford</option><option value="creed">Creed</option><option value="armani">Armani</option><option value="ck">CK</option><option value="dg">D&G</option>
                                    </select>
                                </div>
                                <div class="col-6 mb-3">
                                    <label class="form-label fw-bold small text-muted">Loại</label>
                                    <select class="form-select bg-light border-0" id="new-type"><option value="nam">Nam</option><option value="nu">Nữ</option><option value="unisex">Unisex</option></select>
                                </div>
                               </div>
                                <div class="row">
                                    <div class="col-4 mb-3"><label class="form-label fw-bold small text-muted">Giảm giá (%)</label><input type="number" class="form-control bg-light border-0" id="new-discount" value="0"></div>
                                    <div class="col-4 mb-3"><label class="form-label fw-bold small text-muted">Hàng mới</label><select class="form-select bg-light border-0" id="new-isNew"><option value="false">Không</option><option value="true">Có</option></select></div>
                                    <div class="col-4 mb-3"><label class="form-label fw-bold small text-muted text-warning">★ Nổi bật</label><select class="form-select bg-light border-0" id="new-isFeatured"><option value="false">Không</option><option value="true">Có</option></select></div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <label class="form-label fw-bold small text-muted">Đường dẫn ảnh (VD: pic/tenanh.jpg)</label>
                                <input type="text" class="form-control bg-light border-0 mb-2" id="new-image-path" placeholder="VD: pic/versace.jpg" oninput="document.getElementById('preview-img').src = this.value">
                                <div class="p-2 bg-light rounded text-center border border-dashed" id="preview-box" style="display:block; height: 180px;">
                                    <img id="preview-img" src="https://via.placeholder.com/150" style="max-height: 100%; max-width: 100%; object-fit: contain;">
                                </div>
                                <small class="text-muted" style="font-size: 10px;">*Chép hình vào thư mục pic rồi nhập tên vào đây (VD: pic/ysl.jpg)</small>
                            </div>
                        </div>
                        <hr class="text-muted opacity-25">
                        <h6 class="fw-bold text-success mb-3">Giá & Tồn kho</h6>
                        <div class="input-group mb-2"><span class="input-group-text fw-bold" style="width: 70px;">50ml</span><input type="number" class="form-control" id="price-50" placeholder="Giá"><input type="number" class="form-control border-start-0" id="stock-50" placeholder="Kho" style="background-color: #f0fff4;"></div>
                        <div class="input-group mb-2"><span class="input-group-text fw-bold" style="width: 70px;">75ml</span><input type="number" class="form-control" id="price-75" placeholder="Giá"><input type="number" class="form-control border-start-0" id="stock-75" placeholder="Kho" style="background-color: #f0fff4;"></div>
                        <div class="input-group mb-3"><span class="input-group-text fw-bold" style="width: 70px;">100ml</span><input type="number" class="form-control" id="price-100" placeholder="Giá"><input type="number" class="form-control border-start-0" id="stock-100" placeholder="Kho" style="background-color: #f0fff4;"></div>
                        <div class="mb-3"><label class="form-label fw-bold small text-muted">Mô tả ngắn</label><textarea class="form-control bg-light border-0" id="new-short" rows="2"></textarea></div>
                    </form>
                </div>
                <div class="modal-footer border-top-0 pt-0 pb-4">
                    <button type="button" class="btn btn-light rounded-pill px-4" data-bs-dismiss="modal">Hủy</button>
                    <button type="button" class="btn btn-dark rounded-pill px-4" id="btn-save-new-product">Lưu sản phẩm</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="genericEditModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content rounded-4 border-0 shadow">
                <div class="modal-header"><h5 class="modal-title fw-bold" id="generic-modal-title">Cập nhật</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div>
                <div class="modal-body">
                    <form id="form-generic-edit">
                        <input type="hidden" id="generic-id">
                        <input type="hidden" id="generic-type">
                        <div class="mb-3"><label class="form-label">Tên:</label><input type="text" class="form-control" id="generic-name"></div>
                        <div class="mb-3"><label class="form-label">Mô tả / Ghi chú:</label><textarea class="form-control" id="generic-desc" rows="3"></textarea></div>
                    </form>
                </div>
                <div class="modal-footer border-0"><button type="button" class="btn btn-primary-pro w-100" id="btn-save-generic">Lưu thay đổi</button></div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="orderDetailModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content rounded-4 border-0 shadow-lg">
                <div class="modal-header border-bottom">
                    <h5 class="modal-title fw-bold" id="order-detail-id">Chi tiết đơn hàng</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body p-4">
                    <div class="row mb-4">
                        <div class="col-md-6">
                            <h6 class="text-uppercase text-muted small fw-bold">Thông tin khách hàng</h6>
                            <p class="mb-1 fw-bold" id="od-customer">...</p>
                            <p class="mb-1 small"><i class="bi bi-telephone me-2"></i><span id="od-phone">...</span></p>
                            <p class="mb-1 small"><i class="bi bi-envelope me-2"></i><span id="od-email">...</span></p>
                        </div>
                        <div class="col-md-6">
                             <h6 class="text-uppercase text-muted small fw-bold">Giao nhận</h6>
                             <p class="mb-1 small"><i class="bi bi-geo-alt me-2"></i><span id="od-address">...</span></p>
                             <p class="mb-1 small"><i class="bi bi-calendar3 me-2"></i>Ngày đặt: <span id="od-date">...</span></p>
                             <p class="mb-1 small"><i class="bi bi-credit-card me-2"></i>Thanh toán: <span id="od-payment">...</span></p>
                        </div>
                    </div>

                    <h6 class="text-uppercase text-muted small fw-bold mb-3">Sản phẩm đã mua</h6>
                    <div class="table-responsive bg-light rounded-3 p-3 mb-3">
                        <table class="table table-borderless mb-0 align-middle">
                            <tbody id="od-items-list">
                                </tbody>
                        </table>
                    </div>

                    <div class="d-flex justify-content-between align-items-center border-top pt-3">
                        <span class="fw-bold text-muted">TỔNG CỘNG</span>
                        <span class="fs-4 fw-bold text-danger" id="od-total">0 đ</span>
                    </div>
                </div>
                <div class="modal-footer border-0 bg-light rounded-bottom-4">
                    <button type="button" class="btn btn-dark w-100 fw-bold" data-bs-dismiss="modal">ĐÓNG</button>
                </div>
            </div>
        </div>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script> 
    <script src="admin.js"></script>
    <script>
        document.querySelector('.menu-toggle').addEventListener('click', function() {
            document.querySelector('.sidebar').classList.toggle('active');
        });
    </script>
</body>
</html>